## 摘要

大多数关于文档级事件提取的研究主要集中在以自回归方式构建参数链，这种方法取得了一定的成功，但在训练和推理方面都不够高效。与以前的研究相比，我们提出了一个快速且轻量级的模型，名为PTPCG。在我们的模型中，我们设计了一种新颖的事件参数组合策略，以及通过修剪完整图进行的非自回归解码算法，这些图是在自动选择的伪触发器的指导下构建的。与以前的系统相比，我们的系统在参数数量减少了80.2%的情况下，仍然取得了具有竞争力的结果，资源消耗大大降低，训练只需要3.8%的GPU小时数，推理速度最高可以快8.5倍。此外，我们的模型对带有（或没有）触发器的数据集具有优越的兼容性，伪触发器可以作为注释触发器的补充，以进一步提高性能。代码已在[Github](https://github.com/Spico197/DocEE)上公开。

## 引入

事件提取（EE）的目标是用给定的文本填充事件表。与以触发器为中心的树构建为重点的句子级事件提取（SEE）不同，文档级事件提取（DEE）的目标是从跨多个句子的丰富实体中解码参数组合，并将这些组合填充到事件记录表中，如图1所示，其中注释的触发器通常不可用。

DEE面临的一个挑战是没有触发器的事件参数组合。在DEE数据集中，触发器要么不存在，要么注释质量低，因为大规模数据集通常通过与现有知识库（KB）的远程监督（DS）对齐生成。因此，触发器的缺失推动了近期研究中无触发器参数组合方法的发展。杨等人[2018]首先确定一个关键句子，然后通过找到句子附近的参数来填充事件记录表，而部分全局特征和参数仍然缺失。郑等人[2019]和许等人[2021]充分利用全局上下文，并通过构建有向无环图（DAG）取得了显著的改进。然而，这种基于DAG的方法需要大量的计算资源，因为它们依赖于自回归方式来解码参数组合，这在训练和推理长文档时都是低效的。同时，构建DAG需要大量的内存来存储之前的路径。因此，训练这种基于DAG的DEE模型需要至少四个32GB的GPU，几乎需要一周的时间，而且推理速度也极其慢。

![image-20240526112656989](C:\Users\33580\AppData\Roaming\Typora\typora-user-images\image-20240526112656989.png)

考虑到DEE中的上述挑战以及基于DAG的方法在速度和内存消耗方面的问题，我们在这篇论文中的目标是：1）提出一种适用于触发器感知和无触发器DEE的通用事件参数组合策略；2）提供一个快速且轻量级的文档级事件提取模型。我们提出了一种名为“伪触发器感知修剪完整图（PTPCG）的新型非自回归方法。具体来说，我们将每个参数组合形式化为一个修剪完整图，其中重要的参数被识别并被视为一组伪触发器，它们彼此之间有双向连接，而其他普通参数则以有向方式从这些伪触发器链接。基于带有伪触发器的修剪完整图，我们设计了一种高效的算法，采用非自回归解码策略进行事件参数组合提取。

实验结果显示，我们的PTPCG可以达到与基于DAG的SOTA模型只有19.8%参数的竞争结果，只需要3.8%的GPU小时进行训练，并且在推理方面速度快达8.5倍。此外，我们的PTPCG非常灵活和可扩展，可以用作非自回归触发器基础事件提取的通用架构。如果每个组合只选择一个伪触发器，修剪完整图就变成了像SEE那样的以触发器为中心的树。此外，伪触发器可以作为补充来增强基于注释触发器的方法。

总的来说，我们的贡献包括：

- 我们提出了一种基于伪触发器感知修剪完整图的新型非自回归事件参数组合范式，该范式在文档级事件提取（有或无触发器）中具有兼容性。 
- 我们的模型对于端到端的文档级事件提取是快速且轻量级的，我们进行了广泛的实验以展示其效率和效果。
- 据我们所知，我们的这种方法是第一项探索在DEE中使用一些参数作为伪触发器的效果的工作，我们设计了一个度量来帮助自动选择一组伪触发器。此外，这种度量也可以用于测量DEE中注释触发器的质量。

## 方法

如图2所示，我们的模型可以分为四个组件：1）事件检测执行多标签分类以识别所有可能的事件类型。2）实体提取从文档中提取所有实体并将这些实体编码为密集向量。3）组合提取构建修剪完整图并从这些图中解码参数组合。4）事件记录生成将事件类型的结果和提取的参数组合起来。

![image-20240526112725623](C:\Users\33580\AppData\Roaming\Typora\typora-user-images\image-20240526112725623.png)

对于一个文档$\mathcal{D}$，使用双向长短期记忆网络（BiLSTM）[Hochreiter and Schmidhuber, 1997]将每个句子 $s_i$编码为逐标记的隐藏状态 $(h_{i}^{(1)},h_{i}^{(2)},\ldots,h_{i}^{(|s_{i}|)})$，其中 $h_i^{(j)}\in\mathbb{R}^{d_{h}}$是两个方向表示的连接 $\overrightarrow{h_{i}^{(j)}}\|\overleftrightarrow{h_{i}^{(j)}}$，并且$|s_i|$是第$i$个句子的长度。每个方向上的最后隐藏状态被连接以获得句子表示$g_i\in\mathcal{G}$，即$g_i=\overrightarrow{h_i^{(|s_t|)}}\|\overset{\leftarrow}{\operatorname*{h}}_i^{(0)}$。

随后，我们遵循 Doc2EDAG [Zheng et al., 2019]，并在$G$上使用随机初始化的事件查询和多头注意力来对每个事件类型进行二元分类。事件检测组件的损失函数$\mathcal{L}_\mathrm{det}$被定义为二元交叉熵损失。

## 实体抽取

实体提取任务可以被形式化为一个序列标记任务，采用BIO方案 [Zheng et al.,2019]。为了增强实体识别，我们通过简单的正则表达式匹配将更多的货币、日期、百分比比率和股份实体添加到数据集中。为了处理文档级别的实体提取，我们首先将整个文档分割成句子，并执行句子级别的提及提取。然后，我们使用BiLSTM与CRF [Lample etet al.,2016] 来提取实体提及，使用与事件检测中相同的BiLSTM。实体提取的训练目标是最小化每个句子的CRF的负对数似然损失$\mathcal{L}_\mathrm{ent}$。

对于提及的所有标记，应用最大池化操作在标记级别的表示上以获得提及表示$\tilde{m} _j$。由于提及类型已被证明对下游子模块有效 [Zheng et al., 2019; Xu et al., 2021]，我们通过查找嵌入表将预测的离散提及类型转换为向量。在连接$\tilde{m}_j$和类型嵌入$l_j$之后，我们得到最终的提及表示 $m_{j}=\tilde{m}_{j}\|l_{j}\in\mathbb{R}^{d_{a}}$，其中$d_{a}=d_{h}+d_{l}$，$d_{l}$表示 $l_{j}$的维度。最后，通过另一个最大池化，聚合一个实体的所有提及以获得实体表示$\hat{e}_i$。为了更好地建模实体语义和潜在的组合提取连接，应用了一个额外的BiLSTM层来获得实体表示集合$\mathcal{E}=\{\tilde{e}_i\}_{i=1}^{|\mathcal{E}|}$。

## 组合提取

在本节中，我们将介绍选择伪触发器，构建修剪完整图，以及从图中解码组合的细节。

### 伪触发器选择

由于文档长度和数据集规模的原因，手动注释传统触发器很困难。我们改为以自动方式为每种事件类型选择一组伪触发器。 经验上，触发器是关键词，起两个作用： 1）触发器可以用来识别组合；2）触发器是可以区分不同组合的指纹。 组合由参数构成，我们可以通过找到所有对应的参数来提取特定的组合。 为此，我们设计了一个重要性度量，评估一组参数是否可以作为伪触发器。一般来说，我们首先根据重要性得分为每种事件类型选择一组参数角色作为候选者，并将对应的参数作为伪触发器。

形式上，重要性得分是通过存在性和可区分性获得的。对于类型$t_i$中预定义的参数角色的子集，$\mathcal{R}=\{|r_j\}_{j=1}^{|\mathcal{R}|}$被选为伪触发器候选者。$|\mathcal{R}|$是一个超参数，表示为每个参数组合选择的伪触发器的数量。存在性衡量$\mathcal{R}$的参数是否可以识别组合。$N_e^{(\mathcal{R})}$是至少有一个$\mathcal{R}$的对应参数不为NULL的事件记录的数量，而$N^{(i)}$是$t_i$的总记录数量。可区分性被定义为满足触发器可以区分不同组合，其中 $N_u^{(\mathcal{R})}$是$\mathcal{R}$的参数在同一文档的其他记录中不出现的记录数量。通过存在性和可区分性的乘积，通过选择具有最高重要性得分的候选者来选择伪触发器。
$$
\mathrm{Existence}(\mathcal{R})=\frac{N_e^{(\mathcal{R})}}{N^{(i)}},\quad\mathrm{Distinguish}(\mathcal{R})=\frac{N_u^{(\mathcal{R})}}{N^{(i)}} \\ \operatorname{Importance}(\mathcal{R})=\operatorname{Existence}(\mathcal{R})\times\operatorname{Distinguish}(\mathcal{R})
$$

### 修剪完整图构建

基于DEE任务设置和数据分析，我们提出一个假设，即同一组合中的参数在语义空间中是接近的。根据这个假设，我们将伪触发器作为参数组合的核心，并将每个组合形式化为一个修剪完整图。如图2所示的修剪完整图，对于同一组合中的任何两个参数作为伪触发器$a_{t}^{(i)}$和$a_t^{(j)}$，它们是双向连接的，其中邻接矩阵$y_A^{(i,j)}=y_A^{(j,i)}=1$。对于一个伪触发器$a_t^{(i)}$和同一组合中的一个普通参数$a_o^{(j)}$，它们通过一个定向链接连接，且$y_{A}^{(i,j)}=1$.此外，每个参数$a^{(i)}$都有一个自循环连接，其中$y_{A}^{(i,i)}=1$.$y_{A}$中的其他条目为零，其中不参与任何组合的实体在图中是孤立的节点。

在获得实体表示后，应用点缩放相似性函数（Eqn 2）来估计它们的语义距离：
$$
\tilde{e_{i}}=e_{i}\times W_{s}^{\top}+b_{s},\quad\tilde{e_{j}}=e_{j}\times W_{e}^{\top}+b_{e}\\\tilde{A}_{i,j}=\mathrm{sigmoid}\left(\tilde{e_{i}}^{\top}\tilde{e_{j}}/\sqrt{d_{h}}\right)
$$
其中$\tilde{A}$表示相似性矩阵，$W_s,W_e\in\mathbb{R}^{d_a\times d_a}$和$b_{a}. b_{a}\in \mathbb{R} ^{a_{a}}$是用于语义空间线性投影的可训练参数。 

在训练中，我们使用二元交叉熵函数来形式化组合损$\mathcal{L}_{\mathrm{comb}}$​.

为了预测修剪完整图的二进制邻接矩阵$A$以进行进一步的解码，这里使用了阈值$\gamma$（Eqn 3）。
$$
A_{i,j}=\{\begin{matrix}1&\tilde A_{i,j}\geqslant\gamma\\0&otherwise\end{matrix}
$$

### 非自回归组合解码

基于预测的邻接矩阵$A$，使用非自回归解码算法提取事件参数组合。 首先，根据节点的出度识别所有的伪触发器，并将每个伪触发器组识别为一个团。如果一个实体的出度大于0（除了自循环），那么这个实体就被视为一个伪触发器。对于$|\mathcal{R}|=1$，所有的组合都是伪触发器为中心的树，其中每个组合由一个伪触发器和它的邻居构成。否则，首先应用 Bron-Kerbosch (BK) 算法 [Bron and Kerbosch, 1973] 来找到所有可能的团（图3中的步骤1）。为了应用 BK 算法，参数之间的链接必须是无向的，因此我们首先提取所有双向链接作为无向输入。 

如图3所示，下一步是在组合中找到普通的（非伪触发器）参数。我们进一步利用团中每个伪触发器的所有邻居。之后，执行一个交集操作来找到共享的普通参数。组合由一个伪触发器团和他们共享的普通参数组成。对于那些在组合中只有一个参数的极端记录，所有预测的实体被聚合在一起作为一个默认的组合。

![image-20240526122018462](C:\Users\33580\AppData\Roaming\Typora\typora-user-images\image-20240526122018462.png)

文档的长度并不影响事件记录生成的速度，我们的事件记录生成的时间复杂度是多项式的，即$(\mathcal{O}(N_{t}\times N_{c}))$，而基于DAG的模型的时间复杂度是${\mathcal{O}}({N}_{t}\times N_{s}\times{N}_{r})$，其中$N_{t},N_{c},N_{s},N_{r}$分别是预测类型、组合、预测跨度以及每种类型的角色平均数的数量。在大多数情况下，$N_{s}\times N_{r}\gg N_{c}$，所以我们的PTPCG在速度上始终具有优势。